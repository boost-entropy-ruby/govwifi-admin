<% if team.any? %>
  <table class="govuk-table">
    <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th scope="col" class="govuk-table__header"><%= sort_link "name", "Username" %></th>
      <th scope="col" class="govuk-table__header"><%= sort_link "last_sign_in_at", "Last login" %></th>
      <th scope="col" class="govuk-table__header"><%= sort_link "sign_in_count", "Logins" %></th>
      <th scope="col" class="govuk-table__header"><%= sort_link "email", "Email" %></th>
    </tr>
    </thead>
    <tbody class="govuk-table__body">
      <% team.each do |user| %>
        <tr class="govuk-table__row">
          <td class="govuk-table__cell" scope="row"><%= user.name %></td>
          <td class="govuk-table__cell" scope="row">
            <% if user.last_sign_in_at.present? %>
                <%= user.last_sign_in_at.strftime("%-d %b %Y") %>
            <% end %>
            </td>
          <td class="govuk-table__cell text-right" scope="row"><%= user.sign_in_count %></td>
          <td class="govuk-table__cell text-right" scope="row"><%= user.email %></td>
          <td class="govuk-table__cell text-right" scope="row">
            <%= link_to edit_membership_path(user.membership_for(@organisation), remove_team_member: true),
                        class: "govuk-button red-button" do %>
              Remove user <span class='govuk-visually-hidden'>- <%= user.email %></span>
            <% end %>
          </td>
          <td class="govuk-table__cell text-right" scope="row">
            <% if user.totp_enabled? %>
              <%= link_to({ controller: "users/two_factor_authentication", action: "edit", id: user },
                          class: "govuk-button govuk-button--secondary") do %>
                Reset 2FA <span class='govuk-visually-hidden'>for <%= user.email %></span>
              <% end %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% else %>
  <p class="govuk-body">This organisation has no team members.</p>
<% end %>
